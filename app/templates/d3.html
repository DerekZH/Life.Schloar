<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">

    <title>Life.Scholar</title>

    <!-- Bootstrap core CSS -->
    <link href="../static/css/bootstrap.min.css" rel="stylesheet">
    <script src="../../assets/js/ie-emulation-modes-warning.js"></script>
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">      

  </head>

  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
	<div class="navbar-header">
	  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
	    <span class="sr-only">Toggle navigation</span>
	    <span class="icon-bar"></span>
	    <span class="icon-bar"></span>
	    <span class="icon-bar"></span>
	  </button>
	  <a class="navbar-brand" href="#">Life.Scholar</a>
	</div>
	<div id="navbar" class="collapse navbar-collapse">
	  <ul class="nav navbar-nav">
	    <li class="active"><a href="#">Home</a></li>
	    <li><a href="#about">About</a></li>
	    <li><a href="#contact">Contact</a></li>
	  </ul>
	</div><!--/.nav-collapse -->
      </div>
    </nav>

      
<br><br>
<div class='container-fluid' id='backgroundshade'>
    <div class='container-fluid' id='searchbar'>
        <form action='/output' method="GET" id='form'>
            <div class='col-sm-6'>
                <div class="form-group">
                    <br>
                    <br>
                    <label for="ID"></label>
                        <input type="text" id="ID", name="ID" placeholder="subject, skills, or use your own sentence!">
                </div>
            </div>
            <div class='col-sm-6'>
                <div>
                    <br>
                    <br>
                    <button type="submit" class="btn btn-default btn-lg", >Fetch me some courses!</button>
                    <br>
                    <br>
                </div>
            </div>
        </form>         
    </div>

    <div class="container-fluid">
        <div class="row-fluid">
            <div class="col-sm-8", id='leftpane'>
                <div class='container', id='box', background-color='#eee'> 

                </div>
            </div>
            <div class="col-sm-4", id='rightpane'>
                <div class='container', id='box2'>
                    <br>
                    <br>
                    <p id='w2v_para'> Don't you like these courses?</p>
                </div>
            </div>
        </div>
    </div> 
      
</div>         
      
<!--
    <div id="option">
    <input name="ShowContinentButton" 
           type="button" 
           value="Show Continents" 
           onclick="showcontinents()" />
    </div>
-->
        
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js"></script>

<script>
    $("#box").css('background-color','rgba(240,240,240,0.9)').css('width','850px').css('position','fixed').css('top','17%').css('left','2.7%')//.css('margin-top','-'+$("#box").height()/2+'px').css('margin-left','-'+$("#box").width()/2+'px')
    $("#box2").css('background-color','rgba(240,240,240,0.9)').css('width','450px').css('position','fixed').css('top','17%').css('left','65%')//.css('margin-top','-'+$("#box").height()/2+'px').css('margin-left','-'+$("#box").width()/2+'px')
    $("#w2v_para").css('font-size','16px')
    $('.btn').css('line-height','10px').css('width','250px')
    $("#backgroundshade").css('background-color','rgba(240,240,240,0.9)')
</script>    

      
<script>
  $(function() {
    var w2v_courses = '{{ w2v_courses }}';
    var w2v_courses = w2v_courses.split('*');  
    $( "#ID" ).autocomplete({
      source: w2v_courses
    });
  });
  </script>      
      
<script>
    
var width = 960,
    height = 660;

var tooltip = d3.select("body")
    .append("div")
    .style("position", "absolute")
    .style("z-index", "10")
    .style("width","275px")                  
    .style("height","80px")                 
    .style("padding","2px")             
    .style("font","18px georgia-serif")
    .style("text-anchor", "middle")
    .style("border","1px")      
    .style("border-radius","2px")  
    .style("background", "#cadddd")
    .style("visibility", "hidden");

    
var svg = d3.select("#box").append("svg")
    .attr("width", width+6)
    .attr("height", height);

var circles = svg.append("svg:g")
            .attr("id", "circles");    

var scale = d3.scale.linear()
            .domain([-20,20]).range([0,660])    

var recommended_courses = '{{ recommended_courses }}';
var recommended_courses = recommended_courses.split('*');
    
d3.csv("static/LDA_results_for_d3.csv", function(error, data) {
 
    circles.selectAll("dot")
        .data(data.filter(function (d) {return recommended_courses.indexOf(d.course_name) > -1 })).enter()
        .append("a")
            .attr("xlink:href", function(d) { return d.link; })
        .append("svg:circle")
            .attr("cx", function (d) { return scale(d.tsne_1); })
            .attr("cy", function (d) { return scale(d.tsne_2); })
            .attr("r", "12px")
            .attr("fill", function (d) { return d.color; })
            .attr("stroke","rgba(100,100,100,1)")
            .attr("opacity","1")

        .on("mouseover", function(d){
            tooltip.html("  "+d.course_name+"<br/># Enrollment:"+d.total_enrollment+"<br/>Rating:"+d.rating);
            tooltip.style("visibility", "visible")
            tooltip.style("font-size","18px")
            tooltip.style("top", (event.pageY-10)+"px")
            tooltip.style("left",(event.pageX+10)+"px");
        })
    .on("mouseout", function(){return tooltip.style("visibility", "hidden");});
});

d3.csv("static/LDA_results_for_d3.csv", function(error, data) {
    circles.selectAll("dot")
        .data(data.filter(function (d) {return recommended_courses.indexOf(d.course_name)==-1 }))
        .enter()
        .append("svg:circle")
            .attr("cx", function (d) { return scale(d.tsne_1); })
            .attr("cy", function (d) { return scale(d.tsne_2); })
            .attr("r", "7px")
            .attr("fill", function (d) { return d.color; })
            .attr("stroke","rgba(250,250,250,0.5)")
            .attr("opacity","0.05")
});


d3.select("#box2").append("ul").selectAll("li")
    .data(recommended_courses)
    .enter().append('li')
    .html(function (d) { return d;})
    .style('font-size', '16px')
    .attr('class','list-group-item');

//d3.select("#box2").append("div", ".list-group").selectAll("a")
//    .data(recommended_courses_w2v)
//    .enter().append('li')
//    .html(function (d) { return d;});    
    
//d3.select("#box2").append("p").selectAll("p")
//    .data([1])
//    .enter().append('p')
//    .html('You may also like these broader couress:')
//    .style('font-size', '16px');
//
//
//d3.select("#box2").append("ul").selectAll("li")
//    .data(recommended_courses_lda)
//    .enter().append('li')
//    .html(function (d) { return d;})
//    .style('font-size', '16px')
//    .attr('class','list-group-item');

d3.select("#box2").append("br");
d3.select("#box2").append("br");

d3.select(self.frameElement).style("height", height + "px");
  
    
</script>
      
<!--
<script>
    $(document).ready(function() {
    $.ajax({
        type: "GET",
        url: "static/w2v_courses.tsv",
        dataType: "text",
        success: function(data) { return processData(data);}
     });
    });

    function processData(allText) {
        var allTextLines = allText.split(/\r\n|\n/);
        return allTextLines;
        }
</script>-->
